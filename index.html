<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examenes PMBOK</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: white;
            min-height: 100vh;
            padding: 0px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0px 0px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
		.header {
		    background: var(--header-bg);
		    color: white;
		    padding: 20px;
		    display: flex;
		    justify-content: space-between;
		    align-items: center;
		    gap: 15px;
		}
		
		.logo-container {
		    flex-shrink: 0;
		}
		
		.logo {
		    height: 60px;
		    width: auto;
		    object-fit: contain;
		}
		
		.header-content {
		    flex: 1;
		    text-align: center;
		}

		.header h1 {
			margin-bottom: 0px;
			font-size: 2em;
		}

		.hamburger-menu {
			cursor: pointer;
			padding: 10px;
			z-index: 1000;
			display: flex;
			flex-direction: column;
			gap: 5px;
		}

		.hamburger-icon {
			width: 30px;
			height: 3px;
			background: white;
			display: block;
			border-radius: 3px;
		}

		.hamburger-bars {
			display: flex;
			flex-direction: column;
		}

		.hamburger-menu.active {
			display: none;
		}
		.hamburger-menu.active .hamburger-bars {
			display: none;
		}

		.close-icon {
			display: none;
			font-size: 35px;
			color: white;
			font-weight: 300;
			line-height: 1;
		}

		.hamburger-menu.active .close-icon {
			display: block;
		}

		.side-menu {
			position: fixed;
			top: 0;
			right: -350px;
			width: 350px;
			height: 100%;
			background: white;
			box-shadow: -2px 0 10px rgba(0,0,0,0.3);
			transition: right 0.3s ease;
			z-index: 999;
			overflow-y: auto;
		}

		.side-menu.active {
			right: 0;
		}

		.menu-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0,0,0,0.5);
			opacity: 0;
			visibility: hidden;
			transition: opacity 0.3s, visibility 0.3s;
			z-index: 998;
		}

		.menu-overlay.active {
			opacity: 1;
			visibility: visible;
		}

		.menu-header {
			background: var(--primary-color);
			color: white;
			padding: 15px;
			font-size: 18px;
			font-weight: bold;
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.close-menu-icon {
			font-size: 30px;
			cursor: pointer;
			font-weight: 300;
			line-height: 1;
			transition: transform 0.2s;
		}

		.close-menu-icon:hover {
			transform: scale(1.1);
		}

		.menu-item {
			padding: 10px;
			border-bottom: 1px solid #e0e0e0;
			cursor: pointer;
			transition: background 0.3s;
			display: flex;
			align-items: center;
			font-size: 16px;
			color: #2c3e50;
		}

		.menu-item:hover {
			background: #f5f5f5;
		}

		.menu-item.active {
			background: #e3f2fd;
			border-left: 4px solid var(--primary-color);
			color: var(--primary-color);
			font-weight: bold;
		}

		.menu-item-icon {
			font-size: 24px;
			margin-right: 15px;
			width: 30px;
			text-align: center;
		}
        
		.nav-tabs {
			display: none;
		}
        
        .content {
            padding: 20px;
            min-height: 500px;
        }
        
        .file-upload {
            background: #f8f9fa;
            border: 2px dashed var(--primary-color);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .file-upload input[type="file"] {
            margin: 10px 0;
        }
        
        .btn-upload {
            background: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .btn-upload:hover {
            background: var(--primary-dark);
        }
        
        /* Estilos para √°reas colapsables */
        .area-section {
            margin-bottom: 15px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .area-header {
            background: var(--primary-color);
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .area-header:hover {
            background: var(--primary-dark);
        }
        
        .area-header.collapsed {
            border-bottom: none;
        }
        
        .collapse-icon {
            font-size: 1.2em;
            transition: transform 0.3s;
        }
        
        .area-header.collapsed .collapse-icon {
            transform: rotate(0deg);
        }
        
        .area-header:not(.collapsed) .collapse-icon {
            transform: rotate(90deg);
        }
        
        .results-area-header.collapsed .collapse-icon {
            transform: rotate(0deg);
        }
        
        .results-area-header:not(.collapsed) .collapse-icon {
            transform: rotate(90deg);
        }
        
        .area-content {
			max-height: none;
			overflow: visible;
			transition: max-height 0.3s ease-out;
		}
        
        .area-content.collapsed {
			max-height: 0;
			overflow: hidden;
		}
        
        /* Estilos para la tabla de ex√°menes */
        .exam-list {
            overflow: auto;
            position: relative;
        }
        
        .table-container {
            overflow-x: auto;
            overflow-y: auto;
            max-height: 600px;
            position: relative;
            max-width: 100%;
        }
        
        .exam-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            min-width: 600px;
        }
        
        /* Fijar headers de tabla */
        .exam-table thead th {
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
		/* Estilos espec√≠ficos para tabla de ex√°menes disponibles */
		#examenes .exam-table td:nth-child(1) {
			position: sticky;
			left: 0;
			background: white;
			z-index: 2;
			min-width: 40px;
			max-width: 40px;
			width: 40px;
		}

		#examenes .exam-table td:nth-child(2) {
			position: sticky;
			left: 40px;
			background: white;
			z-index: 2;
			min-width: 130px;
			max-width: 130px;
			word-wrap: break-word;
			overflow-wrap: break-word;
		}

		#examenes .exam-table th:nth-child(1) {
			position: sticky;
			left: 0;
			background: var(--table-header);
			z-index: 15;
			min-width: 40px;
			max-width: 40px;
			width: 40px;
		}

		#examenes .exam-table th:nth-child(2) {
			position: sticky;
			left: 40px;
			background: var(--table-header);
			z-index: 15;
			min-width: 135px;
			max-width: 135px;
			word-wrap: break-word;
			overflow-wrap: break-word;
		}

		/* Estilos espec√≠ficos para tabla de resultados */
		#resultados .exam-table td:nth-child(1) {
			position: sticky;
			left: 0;
			background: white;
			z-index: 2;
			min-width: 40px;
			max-width: 40px;
			width: 40px;
		}

		#resultados .exam-table td:nth-child(2) {
			position: sticky;
			left: 0px;
			background: white;
			z-index: 2;
			min-width: 40px;
			max-width: 40px;
			word-wrap: break-word;
			overflow-wrap: break-word;
		}
		#resultados .exam-table td:nth-child(3) {
			position: sticky;
			left: 40px;
			background: white;
			z-index: 2;
			min-width: 70px;
			max-width: 70px;
			word-wrap: break-word;
			overflow-wrap: break-word;
		}		

		#resultados .exam-table th:nth-child(1) {
			position: sticky;
			left: 0;
			background: var(--table-header);
			z-index: 15;
			min-width: 40px;
			max-width: 40px;
			width: 40px;
		}

		#resultados .exam-table th:nth-child(2) {
			position: sticky;
			left: 0px;
			background: var(--table-header);
			z-index: 15;
			min-width: 40px;
			max-width: 40px;
			word-wrap: break-word;
			overflow-wrap: break-word;
		}
		#resultados .exam-table th:nth-child(3) {
			position: sticky;
			left: 40px;
			background: var(--table-header);
			z-index: 15;
			min-width: 100px;
			max-width: 100px;
			word-wrap: break-word;
			overflow-wrap: break-word;
		}				
        .exam-table th:nth-child(3),
        .exam-table td:nth-child(3) {
            min-width: 100px;
        }
        
        .exam-table th:nth-child(4),
        .exam-table td:nth-child(4) {
            min-width: 30px;
			max-width: 30px;

        }
        
        .exam-table th:nth-child(5),
        .exam-table td:nth-child(5) {
            min-width: 80px;
        }
        
        .exam-table th:nth-child(6),
        .exam-table td:nth-child(6) {
            min-width: 80px;
        }
        
        /* Headers fijos con fondo espec√≠fico para ID y T√≠tulo/Examen */
        .exam-table th:nth-child(1) {
            background: var(--table-header);
            z-index: 15;
        }
        
        .exam-table th:nth-child(2) {
            background: var(--table-header);
            z-index: 15;
        }
        
		/* Filas alternas mantienen su color de fondo en las primeras dos columnas - Ex√°menes */
		#examenes .exam-table tr:nth-child(even) td:nth-child(1),
		#examenes .exam-table tr:nth-child(even) td:nth-child(2) {
			background: #f8f9fa;
		}

		#examenes .exam-table tr:hover td:nth-child(1),
		#examenes .exam-table tr:hover td:nth-child(2) {
			background: #e8f4f8;
		}

		/* Filas alternas mantienen su color de fondo en las primeras dos columnas - Resultados */
		#resultados .exam-table tr:nth-child(even) td:nth-child(1),
		#resultados .exam-table tr:nth-child(even) td:nth-child(2) {
			background: #f8f9fa;
		}

		#resultados .exam-table tr:hover td:nth-child(1),
		#resultados .exam-table tr:hover td:nth-child(2) {
			background: #e8f4f8;
		}
        
        .exam-table th,
        .exam-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .exam-table th {
            background: var(--table-header);
            color: white;
            font-weight: bold;
        }
        
        .exam-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .exam-table tr:hover {
            background: #e8f4f8;
        }
        
        .btn {
            padding: 10px 11px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            margin: 5px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
        }
        
        .btn-success {
            background: #27ae60;
            color: white;
        }
        
        .btn-success:hover {
            background: #27ae60;
        }
        
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        /* Estilos para el examen */
        .exam-header {
            background: var(--primary-color);
            color: white;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            text-align: center;
        }
        
        .exam-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .info-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid var(--primary-color);
        }
        
        .question {
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .question-header {
            background: var(--primary-color);
            color: white;
            padding: 15px;
            font-weight: bold;
        }
        
        .question-content {
            padding: 20px;
        }
        
        .question-text {
            margin-bottom: 15px;
            line-height: 1.6;
            font-size: 16px;
        }
        
        .options {
            list-style: none;
        }
        
        .option {
            margin-bottom: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .option:hover {
            background: #e9ecef;
        }
        
        .option input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        
        .option.selected {
            background: #d4edda;
            border: 2px solid #27ae60;
        }
        
        .exam-controls {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            border-top: 2px solid #ddd;
            position: sticky;
            bottom: 0;
        }
        
        .timer {
            background: #e74c3c;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 10px;
            display: inline-block;
        }
        
        /* Estilos para resultados */
        .result-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .result-header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .score-display {
            font-size: 3em;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .score-good {
            color: #27ae60;
        }
        
        .score-bad {
            color: #e74c3c;
        }
        
        .question-review {
            border-left: 4px solid #ddd;
            padding-left: 15px;
            margin-bottom: 20px;
        }
        
        .question-review.correct {
            border-left-color: #27ae60;
        }
        
        .question-review.incorrect {
            border-left-color: #e74c3c;
        }
        
        .correct-answer {
            color: #27ae60;
            font-weight: bold;
        }
        
        .incorrect-answer {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .error-message {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        /* Estilos espec√≠ficos para resultados por √°rea */
        .results-area-section {
            margin-bottom: 15px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .results-area-header {
            background: var(--primary-color);
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .results-area-header:hover {
            background: var(--primary-dark);
        }
        
        .results-area-content {
            max-height: 2000px;
            overflow: visible;
            transition: max-height 0.3s ease-out;
            background: white;
        }
        
        .results-area-content.collapsed {
            max-height: 0;
            overflow: hidden;
        }
        
		@media (max-width: 768px) {
			.container {
				margin: 0px;
				border-radius: 0;
			}
			
			.header h1 {
				font-size: 1.5em;
			}
			
			.header p {
				font-size: 10px;
			}

			.logo {
		        height: 45px;
		    }
		    
		    .header {
		        padding: 15px;
		        gap: 10px;
				padding left: 24px;
		    }
			
			.side-menu {
				width: 280px;
				right: -280px;
			}
			
			.exam-info {
				grid-template-columns: 1fr;
			}
			
			.exam-table {
				font-size: 14px;
			}
			
			.exam-table th,
			.exam-table td {
				padding: 8px 4px;
			}
			
			.area-header {
				font-size: 14px;
				padding: 12px 15px;
			}
		}
        
        
        /* Estilos para Dashboard */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .metric-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid var(--primary-dark);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .metric-card h3 {
            color: #000000;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #000000;
            margin-bottom: 5px;
        }
        
        .metric-label {
            color: #7f8c8d;
            font-size: 14px;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .area-performance {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 15px;
			border-left: 5px solid #27ae60
        }
        
        .performance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .performance-item:last-child {
            border-bottom: none;
        }
        
        .performance-area {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .performance-score {
            font-weight: bold;
            padding: 5px 12px;
            border-radius: 20px;
            color: white;
        }
        
        .score-excellent {
            background: #27ae60;
        }
        
        .score-good {
            background: #f39c12;
        }
        
        .score-needs-improvement {
            background: #e74c3c;
        }
        
		.chart-container {
			background: white;
			border-radius: 10px;
			padding: 20px;
			box-shadow: 0 4px 15px rgba(0,0,0,0.1);
			margin-bottom: 10px;
			border-left: 5px solid #f39c12
		}

		.recommendations {
			background: white;
			border-radius: 10px;
			padding: 20px;
			box-shadow: 0 4px 15px rgba(0,0,0,0.1);
			border-left: 5px solid #3498db;
			margin-top: 0px;
		}
        
        .recommendation-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #3498db;
        }
        
        .recommendation-item:last-child {
            margin-bottom: 0;
        }
        
        .recommendation-priority {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            margin-right: 10px;
        }
        
        .priority-high {
            background: #e74c3c;
        }
        
        .priority-medium {
            background: #f39c12;
        }
        
        .priority-low {
            background: #95a5a6;
        }
        
        .trend-indicator {
            display: inline-flex;
            align-items: center;
            font-size: 14px;
            margin-left: 10px;
        }
        
        .trend-up {
            color: #27ae60;
        }
        
        .trend-down {
            color: #e74c3c;
        }
        
        .trend-stable {
            color: #95a5a6;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #95a5a6;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .metric-card {
                padding: 15px;
            }
            
            .metric-value {
                font-size: 2em;
            }
            
            .performance-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn:disabled:hover {
            background: #27ae60;
            transform: none;
        }
        
		/* Estilos para modo de selecci√≥n en resultados */
		.result-checkbox {
			margin-right: 10px;
			transform: scale(1.2);
			cursor: pointer;
		}

		#resultados .select-mode-active .exam-table td:first-child {
			min-width: 40px;
			max-width: 40px;
			width: 30px;
		}

		#resultados .select-mode-active .exam-table td:nth-child(2) {
			left: 40px;
			min-width: 55px;
			max-width: 55px;
			width: 55px;
		}

		#resultados .select-mode-active .exam-table td:nth-child(3) {
			left: 95px;
			position: sticky;
			z-index: 2;
			min-width: 110px;
			max-width: 110px;
		}

		#resultados .select-mode-active .exam-table th:first-child {
			min-width: 40px;
			max-width: 40px;
			width: 30px;
			background: var(--table-header);
			z-index: 15;
		}

		#resultados .select-mode-active .exam-table th:nth-child(2) {
			left: 40px;
			min-width: 55px;
			max-width: 55px;
			width: 55px;
			background: var(--table-header);
			z-index: 15;
		}

		#resultados .select-mode-active .exam-table th:nth-child(3) {
			left: 95px;
			position: sticky;
			z-index: 15;
			min-width: 110px;
			max-width: 110px;
			background: var(--table-header);
		}
        
        .select-all-container {
            padding: 15px;
            background: #f8f9fa;
            border-bottom: 1px solid #ddd;
        }
        
        .result-row.selected {
            background-color: #e3f2fd !important;
        }
        
        .select-mode-inactive .result-checkbox {
            display: none;
        }
        
        .hidden {
            display: none;
        }
		
			/* Estilos para selector de temas */
		.theme-options {
			background: white;
			border-radius: 10px;
			padding: 10px;
			box-shadow: 0 0px 0px rgba(0,0,0,0.1);
		}

		.theme-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
			gap: 20px;
			margin-top: 20px;
		}

		.theme-option {
			cursor: pointer;
			text-align: center;
			padding: 20px;
			border-radius: 10px;
			border: 2px solid #ddd;
			transition: all 0.3s ease;
			box-shadow: 0 4px 15px rgba(0,0,0,0.1);
		}

		.theme-option:hover {
			border-color: #A6A6A6;
			transform: translateY(-2px);
			box-shadow: 0 4px 15px rgba(0,0,0,0.1);
		}
		.theme-option:nth-child(1) {
			border-left: 5px solid #2d4373;
		}

		.theme-option:nth-child(2) {
			border-left: 5px solid #1e7e34;
		}

		.theme-option:nth-child(3) {
			border-left: 5px solid #c0611d;
		}

		.theme-option:nth-child(4) {
			border-left: 5px solid #1a1a1a;
		}

		.theme-option.active {
			border-color: var(--primary-color);
			background: #f8f9ff;
		}

		.theme-preview {
			width: 60px;
			height: 40px;
			border-radius: 8px;
			margin: 0 auto 10px;
			border: 2px solid #fff;
			box-shadow: 0 2px 8px rgba(0,0,0,0.2);
		}

		.blue-theme {
			background: linear-gradient(90deg, #2d4373, #1a2642);
		}

		.green-theme {
			background: linear-gradient(90deg, #1e7e34, #145523);
		}

		.orange-theme {
			background: linear-gradient(90deg, #c0611d, #9c4a10);
		}

		.dark-theme {
			background: linear-gradient(90deg, #1a1a1a, #0d0d0d);
		}

		/* Variables CSS para temas */
		:root {
		--primary-color: #1a1a1a;
		--primary-dark: #0d0d0d;
		--primary-light: #2d2d2d;
		--header-bg: linear-gradient(90deg, #1a1a1a, #0d0d0d);
		--table-header: #1a1a1a;
	}

		[data-theme="green"] {
    			--primary-color: #1e7e34;
    			--primary-dark: #155724;
    			--primary-light: #28a745;
    			--header-bg: linear-gradient(90deg, #1e7e34, #145523);
    			--table-header: #1e7e34;
		}
		[data-theme="orange"] {
    			--primary-color: #c0611d;
    			--primary-dark: #9c4a10;
    			--primary-light: #d87020;
    			--header-bg: linear-gradient(90deg, #c0611d, #9c4a10);
    			--table-header: #c0611d;
		}
		[data-theme="blue"] {
    			--primary-color: #2d4373;
    			--primary-dark: #1e2d52;
    			--primary-light: #3d5a99;
    			--header-bg: linear-gradient(90deg, #2d4373, #1a2642);
    			--table-header: #2d4373;
		}
			/* Dise√±o compacto para ex√°menes */
		.exam-cards-container {
			padding: 0;
		}

		.exam-card-compact {
			background: white;
			border-bottom: 1px solid #e0e6ed;
			padding: 15px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			transition: background 0.2s ease;
		}

		.exam-card-compact:hover {
			background: #f8f9fa;
		}

		.exam-card-compact-left {
			flex: 1;
		}

		.exam-card-compact-right {
			margin-left: 15px;
		}

		.exam-card-button-compact {
			padding: 10px 20px;
			border: none;
			border-radius: 6px;
			font-weight: bold;
			font-size: 14px;
			cursor: pointer;
			transition: all 0.3s ease;
			white-space: nowrap;
		}

		.btn-start {
			background: var(--primary-color);
			color: white;
		}

		.btn-start:hover {
			background: #262626;
		}

		.btn-repeat {
			background: var(--primary-color);
			color: white;
		}

		.btn-repeat:hover {
			background: var(--primary-color);
		}

		@media (max-width: 768px) {
			.exam-card-compact {
				padding: 12px 15px;
			}
			
			.exam-card-button-compact {
				padding: 8px 16px;
				font-size: 13px;
			}
		}	
		/* Ajustes para modo selecci√≥n en resultados */
		.select-mode-active .select-mode-column {
			display: flex !important;
			align-items: center;
		}

		.select-mode-active .exam-card-compact {
			padding-left: 10px;
		}

		.result-row.selected {
			background-color: #e3f2fd !important;
		}

		.select-mode-inactive .select-mode-column {
			display: none !important;
		}	

			/* Estilos responsive para vista de examen tipo Kahoot */
		@media (max-width: 768px) {
			#examContainer > div[style*="background: #2c3e50"] {
				padding: 20px 15px !important;
				border-radius: 12px !important;
				margin-bottom: 20px !important;
			}
			
			#examContainer h2 {
				font-size: 18px !important;
				margin-bottom: 5px !important;
			}
			
			#examContainer p {
				font-size: 12px !important;
				margin-bottom: 15px !important;
			}
			
			#examContainer > div > div[style*="background: #34495e"] {
				height: 8px !important;
				margin-bottom: 12px !important;
			}
			
			#timer-container {
				margin-bottom: 10px !important;
			}
			
			#timer {
				font-size: 16px !important;
				padding: 8px 20px !important;
			}
			
			#examContainer div[style*="background: #000000"] {
				padding: 12px !important;
				margin-bottom: 20px !important;
				border-radius: 8px !important;
			}
			
			#examContainer div[style*="background: #000000"] h3 {
				font-size: 14px !important;
				margin: 0 !important;
			}
			
			#examContainer > div > div[style*="font-size: 20px"] {
				font-size: 14px !important;
				line-height: 1.4 !important;
				margin-bottom: 20px !important;
				padding: 0 5px !important;
				text-align: left !important;
			}
			
			#examContainer button[onclick*="selectAnswerKahoot"] {
				padding: 15px 12px !important;
				font-size: 13px !important;
				min-height: auto !important;
				border-radius: 10px !important;
			}
			
			#examContainer > div > div[style*="grid-template-columns: repeat(2, 1fr)"] {
				gap: 12px !important;
				margin-bottom: 20px !important;
			}
			
			#examContainer div[style*="border-left: 6px solid"] {
				padding: 20px 15px !important;
			}
			
			#examContainer div[style*="font-size: 60px"] {
				font-size: 48px !important;
			}
			
			#examContainer h3[style*="font-size: 28px"] {
				font-size: 22px !important;
			}
		}

		@media (max-width: 480px) {
			#examContainer > div[style*="background: #2c3e50"] {
				padding: 15px 12px !important;
			}
			
			#examContainer h2 {
				font-size: 16px !important;
			}
			
			#examContainer div[style*="grid-template-columns: repeat(2, 1fr)"] {
				grid-template-columns: 1fr !important;
			}
			
			#examContainer > div > div[style*="font-size: 20px"] {
				font-size: 13px !important;
			}
			
			#examContainer button[onclick*="selectAnswerKahoot"] {
				padding: 14px 10px !important;
				font-size: 12px !important;
			}
		}
		/* Responsive para estad√≠sticas del resultado */
@media (max-width: 768px) {
    #examContainer div[style*="grid-template-columns: repeat(3, 1fr)"] {
        grid-template-columns: 1fr !important;
        max-width: 300px !important;
        gap: 15px !important;
    }
    
    #examContainer div[style*="font-size: 48px"] {
        font-size: 32px !important;
    }
    
    #examContainer div[style*="padding: 20px"] {
        padding: 15px !important;
    }
    
    #examContainer button[style*="padding: 15px 35px"] {
        padding: 12px 25px !important;
        font-size: 14px !important;
    }
}
    </style>
</head>
	<body>
		<!-- Overlay para cerrar men√∫ -->
		<div class="menu-overlay" id="menuOverlay" onclick="toggleMenu()"></div>
		
		<!-- Men√∫ lateral -->
			<div class="side-menu" id="sideMenu">
				<div class="menu-header">
					<span>Examenes PMBOK</span>
					<span class="close-menu-icon" onclick="toggleMenu()">‚úï</span>
				</div>
			<div class="menu-item active" onclick="navigateTo('examenes')">
				<span class="menu-item-icon">üìù</span>
				<span>Ex√°menes Disponibles</span>
			</div>
			<div class="menu-item" onclick="navigateTo('resultados')">
				<span class="menu-item-icon">üìä</span>
				<span>Mis Resultados</span>
			</div>
			<div class="menu-item" onclick="navigateTo('dashboard')">
				<span class="menu-item-icon">üìà</span>
				<span>Dashboard</span>
			</div>
			<div class="menu-item" onclick="navigateTo('cargar')">
				<span class="menu-item-icon">üìÅ</span>
				<span>Cargar Preguntas</span>
			</div>
			<div class="menu-item" onclick="navigateTo('temas')">
				<span class="menu-item-icon">üé®</span>
				<span>Temas</span>
			</div>
		</div>
		
			<div class="header">
				<div class="logo-container">
					<img src="https://raw.githubusercontent.com/yvillegas126-ship-it/ExamPMBOK/main/logo.png" alt="PMBOK Exams Logo" class="logo">
				</div>
				<div class="header-content">
					<h1>Examenes PMBOK</h1>
					<p>Actualizado a la 7ma Edici√≥n del PMBOK</p>
				</div>
				<div class="hamburger-menu" id="hamburgerMenu" onclick="toggleMenu()">
					<span class="hamburger-icon"></span>
					<span class="hamburger-icon"></span>
					<span class="hamburger-icon"></span>
				</div>
			</div>
        
        <div class="content">
            <!-- Lista de Ex√°menes -->
            <div id="examenes" class="tab-content">
                <h2 style="margin-bottom: 15px;">üìù Ex√°menes Disponibles</h2>
                <div id="examAreas"></div>
            </div>
            
            <!-- Resultados -->
            <div id="resultados" class="tab-content hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px;">
                    <h2>üìä Mis Resultados</h2>
                    <div>
                        <button class="btn btn-primary" onclick="toggleSelectMode()" id="selectModeBtn" style="font-size: 14px; margin-right: 10px;">
                            ‚úÖ Seleccionar
                        </button>
                        <button class="btn btn-success hidden" onclick="deleteSelectedResults()" id="deleteSelectedBtn" style="font-size: 14px; margin-right: 10px;">
                            üóëÔ∏è Borrar Seleccionados
                        </button>
                        <button class="btn btn-danger" onclick="clearAllResults()" style="font-size: 14px;">
                            üóëÔ∏è Borrar Todos los Resultados
                        </button>
                    </div>
                </div>
                <div id="resultsContainer">
                    <p>No has realizado ning√∫n examen a√∫n.</p>
                </div>
            </div>
            
            <!-- Dashboard -->
            <div id="dashboard" class="tab-content hidden">
                <h2 style="margin-bottom: 20px;">üìà Dashboard de Progreso</h2>
                <div id="dashboardContainer">
                    <p>Carga algunos ex√°menes y realiza pruebas para ver tu progreso aqu√≠.</p>
                </div>
            </div>
            
            <!-- Cargar Preguntas -->
            <div id="cargar" class="tab-content hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                    <h2>üìÅ Cargar Preguntas</h2>
                    <button class="btn btn-danger" onclick="clearAllQuestions()" style="font-size: 14px;">
                        üóëÔ∏è Borrar Todas las Preguntas
                    </button>
                </div>
                <div class="file-upload">
                    <p><strong>Instrucciones:</strong></p>
                    <p>Selecciona un archivo CSV con la estructura:</p>
                    <div style="margin-top: 0px; margin-bottom: 0px;">
                        <div style="background: #f5f5f5; border-radius: 3px; padding: 10px;">
                            <code style="font-size: 15px; display: block; line-height: 1.6;">area, titulo_examen, TIEMPO,numero_pregunta, texto_pregunta,opcion_a, opcion_b, opcion_c, opcion_d,respuesta_correcta, explicacion
                            </code>
                        </div>
                    </div>
                    <p><strong>Soporta delimitadores:</strong> Comas (,) y punto y coma (;)</p>
                    <div style="margin-bottom: 10px; max-width: 100%; overflow: hidden; text-align: center;">
                        <input type="file" id="csvFile" accept=".csv" style="margin-bottom: 5px; max-width: 100%; width: auto; display: inline-block;" />
                    </div>
                    <button class="btn-upload" onclick="loadCSVAlternative()">Cargar Preguntas</button>
                </div>
                <div id="loadStatus"></div>
            </div>
			 <!-- Temas -->
			<div id="temas" class="tab-content hidden">
				<h2 style="margin-bottom: 10px;">üé® Personalizar Tema</h2>
				<div class="theme-options">
					<p style="margin-bottom: 20px; font-style: italic;">Selecciona un color de tema para personalizar la interfaz:</p>
					<div class="theme-grid">
						<div class="theme-option" onclick="changeTheme('blue')">
							<div class="theme-preview blue-theme"></div>
							<span>Azul</span>
						</div>
						<div class="theme-option" onclick="changeTheme('green')">
							<div class="theme-preview green-theme"></div>
							<span>Verde</span>
						</div>
						<div class="theme-option" onclick="changeTheme('orange')">
							<div class="theme-preview orange-theme"></div>
							<span>Naranja</span>
						</div>
						<div class="theme-option" onclick="changeTheme('dark')">
							<div class="theme-preview dark-theme"></div>
							<span>Oscuro (Por defecto)</span>
						</div>
					</div>
				</div>
			</div>           
            <!-- √Årea del Examen -->
            <div id="examArea" class="tab-content hidden">
                <div id="examContainer"></div>
            </div>
        </div>
    </div>

    <script>
        let exams = [];
        let currentExam = null;
        let currentAnswers = {};
        let examStartTime = null;
        let examTimer = null;
        let examResults = [];
		let timeLeft = 0;
        
		// Funciones para el men√∫ hamburguesa
		function toggleMenu() {
			const sideMenu = document.getElementById('sideMenu');
			const menuOverlay = document.getElementById('menuOverlay');
			const hamburgerMenu = document.getElementById('hamburgerMenu');
			
			sideMenu.classList.toggle('active');
			menuOverlay.classList.toggle('active');
			hamburgerMenu.classList.toggle('active');
		}

		function navigateTo(tabName) {
			// Cerrar men√∫
			toggleMenu();
			
			// Actualizar items del men√∫
			document.querySelectorAll('.menu-item').forEach(item => {
				item.classList.remove('active');
			});
			event.target.closest('.menu-item').classList.add('active');
			
			// Mostrar contenido
			showTab(tabName);
		}

        // Cargar datos guardados al inicio
		function init() {
			 // Primero cargar resultados
			const savedResults = localStorage.getItem('examResults');
			if (savedResults) {
				examResults = JSON.parse(savedResults);
			}
			// Luego cargar ex√°menes
			const savedExams = localStorage.getItem('examData');
			if (savedExams) {
				exams = JSON.parse(savedExams);
				displayExamList();
			}
			 // SIEMPRE mostrar la lista (con o sin ex√°menes)
			displayExamList();
			// Cargar tema guardado
			loadSavedTheme();
		}
        
        // Parsear tiempo desde formato H:MM:SS a minutos
        function parseTime(timeStr) {
            const parts = timeStr.split(':');
            const hours = parseInt(parts[0]) || 0;
            const minutes = parseInt(parts[1]) || 0;
            const seconds = parseInt(parts[2]) || 0;
            return hours * 60 + minutes + (seconds > 0 ? 1 : 0);
        }
        
        // Cargar CSV con codificaci√≥n alternativa
        function loadCSVAlternative() {
            const fileInput = document.getElementById('csvFile');
            const statusDiv = document.getElementById('loadStatus');
            
            if (!fileInput.files[0]) {
                statusDiv.innerHTML = '<div class="error-message">Por favor selecciona un archivo CSV.</div>';
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    processCSVData(e.target.result, statusDiv);
                } catch (error) {
                    statusDiv.innerHTML = `<div class="error-message">Error al procesar el archivo: ${error.message}</div>`;
                }
            };
            
            reader.readAsText(file, 'ISO-8859-1');
        }
        
        // Funci√≥n com√∫n para procesar datos CSV
        function processCSVData(csvData, statusDiv) {
            csvData = csvData
                .replace(/√É∆í√Ç¬±/g, '√±')
                .replace(/√É∆í√Ç¬°/g, '√°')
                .replace(/√É∆í√Ç¬©/g, '√©')
                .replace(/√É∆í√Ç¬≠/g, '√≠')
                .replace(/√É∆í√Ç¬≥/g, '√≥')
                .replace(/√É∆í√Ç¬∫/g, '√∫')
                .replace(/√É∆í/g, '√Å')
                .replace(/√É∆í√Ç¬ø/g, '√â')
                .replace(/√É∆í/g, '√ç')
                .replace(/√É∆í"/g, '√ì')
                .replace(/√É∆í√Ö¬°/g, '√ö')
                .replace(/√É∆í'N/g, '√ë')
                .replace(/√É¬¢√¢‚Äö¬¨√¢‚Äû¬¢/g, "'")
                .replace(/√É¬¢√¢‚Äö¬¨√Ö"/g, '"')
                .replace(/√É¬¢√¢‚Äö¬¨/g, '"');
            
            const delimiter = detectDelimiter(csvData);
            console.log(`Delimitador detectado: "${delimiter}"`);
            
            const lines = csvData.split('\n');
            const dataLines = lines.slice(1).filter(line => line.trim());
            
            if (dataLines.length === 0) {
                throw new Error('El archivo CSV est√° vac√≠o o solo contiene headers.');
            }
            
            const parsedData = [];
            const examGroups = {};
            
            dataLines.forEach((line, index) => {
                const columns = parseCSVLine(line, delimiter);
                
                console.log(`L√≠nea ${index + 2}: Encontradas ${columns.length} columnas:`, columns);
                
                if (columns.length < 11) {
                    const missingCount = 11 - columns.length;
                    throw new Error(`L√≠nea ${index + 2}: Faltan ${missingCount} columna(s). Se esperan 11 columnas, encontradas ${columns.length}.\nDelimitador usado: "${delimiter}"\nContenido de la l√≠nea: "${line}"\nColumnas detectadas: [${columns.map((col, i) => `${i+1}: "${col}"`).join(', ')}]`);
                }
                
                const [area, titulo, tiempo, numeroPregunta, textoPregunta, opcionA, opcionB, opcionC, opcionD, respuestaCorrecta, explicacion] = columns;
                        
                const correctAnswerText = respuestaCorrecta.toLowerCase().trim();
                let correctIndex;
                
                const letterMatch = correctAnswerText.match(/^([abcd])\)?/);
                if (letterMatch) {
                    const letter = letterMatch[1];
                    switch(letter) {
                        case 'a': correctIndex = 0; break;
                        case 'b': correctIndex = 1; break;
                        case 'c': correctIndex = 2; break;
                        case 'd': correctIndex = 3; break;
                    }
                } else {
                    const options = [opcionA.trim(), opcionB.trim(), opcionC.trim(), opcionD.trim()];
                    correctIndex = options.findIndex(option => 
                        correctAnswerText.includes(option.toLowerCase()) || 
                        option.toLowerCase().includes(correctAnswerText)
                    );
                    
                    if (correctIndex === -1) {
                        throw new Error(`L√≠nea ${index + 2}: Respuesta correcta inv√°lida: "${respuestaCorrecta}". Use a, b, c, d, a), b), c), d) o el texto exacto de una de las opciones.`);
                    }
                }
                
                const questionData = {
                    area: area.trim(),
                    titulo: titulo.trim(),
                    tiempo: tiempo.trim(),
                    numeroPregunta: parseInt(numeroPregunta),
                    textoPregunta: textoPregunta.trim(),
                    opciones: [opcionA.trim(), opcionB.trim(), opcionC.trim(), opcionD.trim()],
                    respuestaCorrecta: correctIndex,
                    explicacion: explicacion.trim()
                };
                
                parsedData.push(questionData);
                
                const examKey = `${questionData.area}_${questionData.titulo}`;
                if (!examGroups[examKey]) {
                    examGroups[examKey] = {
                        area: questionData.area,
                        titulo: questionData.titulo,
                        tiempo: questionData.tiempo,
                        questions: []
                    };
                }
                
                examGroups[examKey].questions.push({
                    id: questionData.numeroPregunta,
                    text: questionData.textoPregunta,
                    options: questionData.opciones,
                    correctAnswer: questionData.respuestaCorrecta,
                    explanation: questionData.explicacion
                });
            });
            
            exams = [];
            let examId = 1;
            
            Object.values(examGroups).forEach(group => {
                group.questions.sort((a, b) => a.id - b.id);
                
                const exam = {
                    id: examId++,
                    title: group.titulo,
                    area: group.area,
                    time: parseTime(group.tiempo),
                    questions: group.questions
                };
                
                exams.push(exam);
            });
            
            localStorage.setItem('examData', JSON.stringify(exams));
            
            statusDiv.innerHTML = `<div class="success-message">¬°Archivo cargado exitosamente! Se crearon ${exams.length} examen(es) con ${parsedData.length} pregunta(s) en total.</div>`;
            
            displayExamList();
        }
        
        // Detectar el delimitador del CSV
        function detectDelimiter(csvData) {
            const firstLine = csvData.split('\n')[0];
            const commaCount = (firstLine.match(/,/g) || []).length;
            const semicolonCount = (firstLine.match(/;/g) || []).length;
            
            return semicolonCount > commaCount ? ';' : ',';
        }
        
        // Parsear l√≠nea CSV considerando diferentes delimitadores
        function parseCSVLine(line, delimiter = ',') {
            const result = [];
            let current = '';
            let inQuotes = false;
            let i = 0;
            
            while (i < line.length) {
                const char = line[i];
                
                if (char === '"' && (i === 0 || line[i-1] === delimiter || inQuotes)) {
                    if (inQuotes && i + 1 < line.length && line[i + 1] === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === delimiter && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
                i++;
            }
            
            result.push(current.trim());
            return result.filter((item, index, arr) => index === arr.length - 1 || item !== '');
        }
        
        // Mostrar lista de ex√°menes agrupados por √°rea
		 function displayExamList() {
			const examAreas = document.getElementById('examAreas');
			examAreas.innerHTML = '';
			
			if (exams.length === 0) {
				examAreas.innerHTML = '<p style="text-align: center; color: #666; padding: 40px; font-style: italic;">No hay ex√°menes cargados. Usa la pesta√±a "Cargar Preguntas" para a√±adir ex√°menes.</p>';
				return;
			}
			
			// Agrupar ex√°menes por √°rea
			const areaGroups = {};
			const areaOrder = [];
			
			exams.forEach(exam => {
				if (!areaGroups[exam.area]) {
					areaGroups[exam.area] = [];
					areaOrder.push(exam.area);
				}
				areaGroups[exam.area].push(exam);
			});
			
			// Crear secciones colapsables para cada √°rea
			areaOrder.forEach(area => {
				const areaExams = areaGroups[area];
				const areaSection = document.createElement('div');
				areaSection.className = 'area-section';
				
				const areaHeader = document.createElement('div');
				areaHeader.className = 'area-header collapsed';
				areaHeader.onclick = () => toggleAreaSection(area);
				areaHeader.innerHTML = `
					<span>√ÅREA: ${area} (${areaExams.length} examenes)</span>
					<span class="collapse-icon">‚ñ∂</span>
				`;
				
				const areaContent = document.createElement('div');
				areaContent.className = 'area-content collapsed';
				areaContent.id = `area-${area}`;
				
				let cardsHTML = '<div class="exam-cards-container">';
				
				areaExams.forEach(exam => {
					const hasResult = examResults.find(r => r.examId === exam.id);
					const statusText = hasResult ? `üéØ Estado: ${hasResult.score}%` : 'üéØ Estado: Pendiente';
					const statusColor = hasResult ? 'color: #27ae60;' : 'color: #f39c12;';
					const buttonClass = hasResult ? 'btn-repeat' : 'btn-start';
					const buttonText = hasResult ? 'Repetir' : 'Iniciar';
					
					cardsHTML += `
						<div class="exam-card-compact">
							<div class="exam-card-compact-left">
								<div style="font-size: 12px; color: #7f8c8d; margin-bottom: 2px; padding-left: 3px;">ID: ${exam.id}</div>
								<div style="font-size: 16px; font-weight: bold; color: #2c3e50; margin-bottom: 4px;">${exam.title}</div>
								<div style="font-size: 13px; color: #7f8c8d;">üìù ${exam.questions.length} preguntas en ${exam.time}:00 min</div>
								<div style="font-size: 13px; font-weight: bold; margin-top: 4px; ${statusColor}">${statusText}</div>
							</div>
							<div class="exam-card-compact-right">
								<button class="exam-card-button-compact ${buttonClass}" onclick="startExam(${exam.id})">
									${buttonText}
								</button>
							</div>
						</div>
					`;
				});
				
				cardsHTML += '</div>';
				areaContent.innerHTML = cardsHTML;
				areaSection.appendChild(areaHeader);
				areaSection.appendChild(areaContent);
				examAreas.appendChild(areaSection);
			});
		}
        
        // Toggle de secci√≥n de √°rea
        function toggleAreaSection(area) {
            const content = document.getElementById(`area-${area}`);
            const header = content.previousElementSibling;
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                header.classList.remove('collapsed');
            } else {
                content.classList.add('collapsed');
                header.classList.add('collapsed');
            }
        }
        
        // Mostrar resultados agrupados por √°rea
        function displayResults() {
		const container = document.getElementById('resultsContainer');
		
		if (examResults.length === 0) {
			container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px; font-style: italic;">No has realizado ning√∫n examen a√∫n.</p>';
			return;
		}
		
		// Agrupar resultados por √°rea
		const areaResults = {};
		const areaOrder = [];
		
		examResults.forEach((result, index) => {
			const exam = exams.find(e => e.id === result.examId);
			if (exam) {
				const area = exam.area;
				if (!areaResults[area]) {
					areaResults[area] = [];
					areaOrder.push(area);
				}
				areaResults[area].push({...result, globalIndex: index});
			}
		});
		
		let resultsHTML = '';
		
		areaOrder.forEach(area => {
			const results = areaResults[area];
			
			resultsHTML += `
				<div class="results-area-section">
					<div class="results-area-header collapsed" onclick="toggleResultsArea('${area}')">
						<span>√ÅREA: ${area} (${results.length} resultado${results.length > 1 ? 's' : ''})</span>
						<span class="collapse-icon">‚ñ∂</span>
					</div>
					<div class="results-area-content collapsed" id="results-area-${area}">
						<div class="select-all-container" id="selectAll-${area}" style="display: none;">
							<label style="display: flex; align-items: center; cursor: pointer; padding: 10px 15px;">
								<input type="checkbox" class="result-checkbox" onchange="selectAllInArea('${area}')" id="selectAll-${area}-checkbox">
								<span style="font-weight: bold; margin-left: 8px;">Seleccionar todos en ${area}</span>
							</label>
						</div>
						<div class="exam-cards-container">
			`;
			
			results.forEach(result => {
				const exam = exams.find(e => e.id === result.examId);
				const scoreColor = result.score >= 70 ? '#27ae60' : '#e74c3c';
				
				resultsHTML += `
					<div class="exam-card-compact result-row" data-result-index="${result.globalIndex}">
						<div class="select-mode-column" style="display: none; margin-right: 10px;">
							<input type="checkbox" class="result-checkbox" value="${result.globalIndex}" onchange="updateSelectedCount()">
						</div>
						<div class="exam-card-compact-left">
							<div style="font-size: 12px; color: #7f8c8d; margin-bottom: 2px; padding-left: 3px;">ID: ${result.examId}</div>
							<div style="font-size: 16px; font-weight: bold; color: #2c3e50; margin-bottom: 4px;">${result.examTitle}</div>
							<div style="font-size: 13px; color: #7f8c8d; margin-bottom: 2px; ">
							üìÖFecha: ${result.date}
							</div>
							<div style="font-size: 13px; color: #7f8c8d;">
							‚è±Ô∏èDuraci√≥n: ${result.timeSpent} min
							</div>
							<div style="font-size: 13px; font-weight: bold; margin-top: 4px; color: ${scoreColor};">
							üéØAciertos: ${result.correctAnswers}/${result.totalQuestions}
							</div>
						</div>
						<div class="exam-card-compact-right">
							<div style="font-size: 32px; font-weight: bold; color: ${scoreColor};">
								${result.score}%
							</div>
						</div>
					</div>
				`;
			});
			
			resultsHTML += `
						</div>
					</div>
				</div>
			`;
		});
		
		container.innerHTML = resultsHTML;
		
		const resultsContainer = document.getElementById('resultsContainer');
		resultsContainer.classList.add('select-mode-inactive');
		resultsContainer.classList.remove('select-mode-active');
	}
        // Toggle de secci√≥n de resultados por √°rea
        function toggleResultsArea(area) {
            const content = document.getElementById(`results-area-${area}`);
            const header = content.previousElementSibling;
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                header.classList.remove('collapsed');
            } else {
                content.classList.add('collapsed');
                header.classList.add('collapsed');
            }
        }
        
        let selectMode = false;
        
        // Toggle modo de selecci√≥n
        function toggleSelectMode() {
            selectMode = !selectMode;
            const selectModeBtn = document.getElementById('selectModeBtn');
            const deleteSelectedBtn = document.getElementById('deleteSelectedBtn');
            const selectColumns = document.querySelectorAll('.select-mode-column');
            const selectAllContainers = document.querySelectorAll('.select-all-container');
            const resultsContainer = document.getElementById('resultsContainer');
            
            if (selectMode) {
                selectModeBtn.textContent = '‚ùå Cancelar';
                selectModeBtn.className = 'btn btn-danger';
                deleteSelectedBtn.classList.remove('hidden');
                
                // Inicializar estado del bot√≥n borrar
                deleteSelectedBtn.textContent = 'üóëÔ∏è Borrar Seleccionados';
                deleteSelectedBtn.disabled = true;
                deleteSelectedBtn.style.opacity = '0.5';
                deleteSelectedBtn.style.cursor = 'not-allowed';
                
                // Mostrar columnas de selecci√≥n
                selectColumns.forEach(col => col.style.display = '');
                selectAllContainers.forEach(container => container.style.display = '');
                resultsContainer.classList.add('select-mode-active');
                resultsContainer.classList.remove('select-mode-inactive');
            } else {
                selectModeBtn.textContent = '‚òëÔ∏è Seleccionar';
                selectModeBtn.className = 'btn btn-primary';
                deleteSelectedBtn.classList.add('hidden');
                
                // Ocultar columnas de selecci√≥n
                selectColumns.forEach(col => col.style.display = 'none');
                selectAllContainers.forEach(container => container.style.display = 'none');
                resultsContainer.classList.remove('select-mode-active');
                resultsContainer.classList.add('select-mode-inactive');
                
                // Limpiar selecciones
                document.querySelectorAll('.result-checkbox').forEach(cb => {
                    cb.checked = false;
                });
                document.querySelectorAll('.result-row').forEach(row => {
                    row.classList.remove('selected');
                });
            }
        }
        
        // Actualizar contador de seleccionados
        function updateSelectedCount() {
            const selectedCheckboxes = document.querySelectorAll('.result-checkbox[value]:checked');
            const deleteSelectedBtn = document.getElementById('deleteSelectedBtn');
            const count = selectedCheckboxes.length;
            
            if (count > 0) {
                deleteSelectedBtn.textContent = `üóëÔ∏è Borrar Seleccionados (${count})`;
                deleteSelectedBtn.disabled = false;
                deleteSelectedBtn.style.opacity = '1';
                deleteSelectedBtn.style.cursor = 'pointer';
            } else {
                deleteSelectedBtn.textContent = 'üóëÔ∏è Borrar Seleccionados';
                deleteSelectedBtn.disabled = true;
                deleteSelectedBtn.style.opacity = '0.5';
                deleteSelectedBtn.style.cursor = 'not-allowed';
            }
            
            // Actualizar estilo visual de filas seleccionadas
            document.querySelectorAll('.result-row').forEach(row => {
                const checkbox = row.querySelector('.result-checkbox[value]');
                if (checkbox && checkbox.checked) {
                    row.classList.add('selected');
                } else {
                    row.classList.remove('selected');
                }
            });
        }
        
        // Seleccionar todos en un √°rea
        function selectAllInArea(area) {
            const areaContainer = document.getElementById(`results-area-${area}`);
            const selectAllCheckbox = document.getElementById(`selectAll-${area}-checkbox`);
            const areaCheckboxes = areaContainer.querySelectorAll('.result-checkbox[value]');
            
            areaCheckboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
            
            updateSelectedCount();
        }
        
        // Eliminar resultados seleccionados
        function deleteSelectedResults() {
            const selectedCheckboxes = document.querySelectorAll('.result-checkbox[value]:checked');
            
            if (selectedCheckboxes.length === 0) {
                alert('No hay resultados seleccionados para eliminar.');
                return;
            }
            
            const selectedIndices = Array.from(selectedCheckboxes).map(cb => parseInt(cb.value));
            const count = selectedIndices.length;
            
            if (confirm(`¬øEst√°s seguro de que quieres borrar ${count} resultado${count > 1 ? 's' : ''}? Esta acci√≥n no se puede deshacer.`)) {
                // Ordenar √≠ndices en orden descendente para eliminar correctamente
                selectedIndices.sort((a, b) => b - a);
                
                // Eliminar resultados de la array
                selectedIndices.forEach(index => {
                    examResults.splice(index, 1);
                });
                
                // Guardar en localStorage
                localStorage.setItem('examResults', JSON.stringify(examResults));
                
                // Salir del modo de selecci√≥n y actualizar vista
                selectMode = true; // Para que toggleSelectMode() funcione correctamente
                toggleSelectMode();
                displayResults();
                
                alert(`${count} resultado${count > 1 ? 's han' : ' ha'} sido eliminado${count > 1 ? 's' : ''}.`);
            }
        }
        
        // Borrar todas las preguntas
        function clearAllQuestions() {
            if (confirm('¬øEst√°s seguro de que quieres borrar TODAS las preguntas/ex√°menes? Esta acci√≥n eliminar√° todos los ex√°menes cargados y no se puede deshacer.')) {
                exams = [];
                localStorage.removeItem('examData');
                displayExamList();
                alert('Todas las preguntas y ex√°menes han sido eliminados.');
            }
        }
        
        // Borrar todos los resultados
        function clearAllResults() {
            if (confirm('¬øEst√°s seguro de que quieres borrar TODOS los resultados? Esta acci√≥n no se puede deshacer.')) {
                examResults = [];
                localStorage.removeItem('examResults');
                displayResults();
                alert('Todos los resultados han sido eliminados.');
            }
        }
        
        // Cambiar entre pesta√±as
		function showTab(tabName) {
			const tabs = document.querySelectorAll('.tab-content');
			tabs.forEach(tab => tab.classList.add('hidden'));
			
			// Resetear modo de selecci√≥n al cambiar de pesta√±a
			if (selectMode && tabName !== 'resultados') {
				selectMode = true;
				toggleSelectMode();
			}
			
			document.getElementById(tabName).classList.remove('hidden');
			
			if (tabName === 'examenes') {
				displayExamList();
			} else if (tabName === 'resultados') {
				displayResults();
			} else if (tabName === 'dashboard') {
				displayDashboard();
			}
		}
        
        // Iniciar examen
		function startExam(examId) {
			currentExam = exams.find(exam => exam.id === examId);
			if (!currentExam) return;
			
			currentAnswers = {};
			examStartTime = new Date();
			timeLeft = 0; // ‚Üê AGREGA ESTA L√çNEA para resetear el tiempo
			
			displayExam();
			startTimer();
			
			document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
			document.getElementById('examArea').classList.remove('hidden');
		}
        
        // Mostrar examen
			function displayExam() {
				const container = document.getElementById('examContainer');
				let currentQuestionIndex = 0;
				
				function showQuestion(index) {
					const question = currentExam.questions[index];
					const progress = ((index) / currentExam.questions.length) * 100;
					// Inicializar timeLeft si es la primera vez
					if (timeLeft === 0) {
						timeLeft = currentExam.time * 60;
					}
					
					container.innerHTML = `
						<div style="background: var(--primary-color); color: white; padding: 15px; border-radius: 15px; margin-bottom: 10px; text-align: center;">
							<h2 style="margin-bottom: 10px; font-size: 24px;">${currentExam.title}</h2>
							<p style="margin-bottom: 15px; font-size: 14px;">√Årea: ${currentExam.area}</p>
							<div style="background: var(--header-bg); height: 12px; border-radius: 10px; overflow: hidden; margin-bottom: 15px;">
								<div style="background: white; height: 100%; width: ${progress}%; transition: width 0.3s;"></div>
							</div>
							<p style="font-size: 16px;">Pregunta ${index + 1} de ${currentExam.questions.length}</p>
						</div>
						
						${currentAnswers[question.id] !== undefined ? `
							<div style="background: white; border-radius: 15px; padding: 40px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-left: 6px solid ${currentAnswers[question.id] === question.correctAnswer ? '#27ae60' : '#e74c3c'};">
								<div style="text-align: center; margin-bottom: 0px;">
									<div style="font-size: 60px; margin-bottom: 15px;">
										${currentAnswers[question.id] === question.correctAnswer ? 'üéâ' : 'üòî'}
									</div>
									<h3 style="font-size: 28px; color: ${currentAnswers[question.id] === question.correctAnswer ? '#27ae60' : '#e74c3c'}; margin-bottom: 10px;">
										${currentAnswers[question.id] === question.correctAnswer ? '¬°Correcto!' : 'Incorrecto'}
									</h3>
								</div>
								
								<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 0px;">
									<p style="margin: 0; font-size: 16px;"><strong>üìñ Explicaci√≥n:</strong></p>
									<p style="margin: 10px 0 0 0; line-height: 1.6; color: #555;">${question.explanation}</p>
								</div>
								
								${currentAnswers[question.id] !== question.correctAnswer ? `
									<div style="background: #d4edda; padding: 15px; border-radius: 10px; border-left: 4px solid #27ae60;">
										<p style="margin: 0;"><strong>‚úÖ La respuesta correcta era:</strong></p>
										<p style="margin: 5px 0 0 0; color: #155724;">${String.fromCharCode(97 + question.correctAnswer)}) ${question.options[question.correctAnswer].replace(/^[a-d]\)\s*/i, '')}</p>
									</div>
								` : ''}
								
								<div style="text-align: center; margin-top: 0px;">
									<button class="btn btn-primary" onclick="nextQuestion()" style="padding: 15px 40px; font-size: 16px; border-radius: 25px;">
										${index < currentExam.questions.length - 1 ? 'Siguiente Pregunta ‚Üí' : 'Ver Resultados üèÜ'}
									</button>
								</div>
							</div>
						` : `
							<div style="background: white; border-radius: 15px; padding: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 0px;">
								<div id="timer-container" style="text-align: center; margin-bottom: 30px;">
									<div style="background: #e74c3c; color: white; padding: 15px 30px; border-radius: 30px; display: inline-block; font-size: 24px; font-weight: bold;" id="timer">
										${Math.floor(timeLeft / 60).toString().padStart(2, '0')}:${(timeLeft % 60).toString().padStart(2, '0')}
									</div>
								</div>
								
								<div style="background: var(--primary-color); color: white; padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 15px;">
									<h3 style="margin: 0; font-size: 18px; font-weight: bold;">Pregunta ${index + 1}</h3>
								</div>
								
								<div style="font-size: 20px; color: #2c3e50; margin-bottom: 30px; line-height: 1.6; text-align: center; font-weight: 500;">
									${question.text}
								</div>
								
								<div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; max-width: 900px; margin: 0 auto;">
									${question.options.map((option, optionIndex) => {
										let cleanOption = option.replace(/^[a-d]\)\s*/i, '');
										const colors = ['#e74c3c', '#3498db', '#f39c12', '#27ae60'];
										return `
											<button 
												onclick="selectAnswerKahoot(${question.id}, ${optionIndex})"
												style="background: ${colors[optionIndex]}; color: white; border: none; padding: 25px 20px; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.2);"
												onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 6px 20px rgba(0,0,0,0.3)';"
												onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 10px rgba(0,0,0,0.2)';"
											>
												${cleanOption}
											</button>
										`;
									}).join('')}
								</div>
							</div>
							
							<div style="text-align: center; margin-top: 5px;">
								<button class="btn btn-danger" onclick="cancelExam()" style="padding: 12px 30px; border-radius: 25px;">Abandonar Examen</button>
							</div>
						`}
					`;
				}
				
				window.selectAnswerKahoot = function(questionId, answerIndex) {
					currentAnswers[questionId] = answerIndex;
					
					// PAUSAR EL CRON√ìMETRO cuando se responde
					if (examTimer) {
						clearInterval(examTimer);
					}
					
					showQuestion(currentQuestionIndex);
				};
				
				window.nextQuestion = function() {
					currentQuestionIndex++;
					if (currentQuestionIndex < currentExam.questions.length) {
						showQuestion(currentQuestionIndex);
						// REINICIAR el cron√≥metro para la siguiente pregunta
						startTimer();
					} else {
						submitExam();
					}
				};
				
				showQuestion(currentQuestionIndex);
			}
        
        // Seleccionar respuesta
        function selectAnswer(questionId, answerIndex) {
            currentAnswers[questionId] = answerIndex;
            
            const radio = document.getElementById(`q${questionId}o${answerIndex}`);
            radio.checked = true;
            
            const questionOptions = document.querySelectorAll(`input[name="question${questionId}"]`);
            questionOptions.forEach(option => {
                option.parentElement.classList.remove('selected');
            });
            radio.parentElement.classList.add('selected');
        }
        
        // Temporizador
		function startTimer() {
			// Solo inicializar timeLeft si es la primera pregunta
			if (timeLeft === 0) {
				timeLeft = currentExam.time * 60;
			}
			
			examTimer = setInterval(() => {
				timeLeft--;
				
				const minutes = Math.floor(timeLeft / 60);
				const seconds = timeLeft % 60;
				
				const timerElement = document.getElementById('timer');
				if (timerElement) {
					timerElement.textContent = 
						`${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
				}
				
				if (timeLeft <= 0) {
					clearInterval(examTimer);
					submitExam();
				}
			}, 1000);
		}
        // Enviar examen
        function submitExam() {
            if (examTimer) {
                clearInterval(examTimer);
            }
            
            let correctAnswers = 0;
            const totalQuestions = currentExam.questions.length;
            
            currentExam.questions.forEach(question => {
                if (currentAnswers[question.id] === question.correctAnswer) {
                    correctAnswers++;
                }
            });
            
            const score = Math.round((correctAnswers / totalQuestions) * 100);
            
            const result = {
                examId: currentExam.id,
                examTitle: currentExam.title,
                score: score,
                correctAnswers: correctAnswers,
                totalQuestions: totalQuestions,
                answers: currentAnswers,
                date: formatDate(new Date()),
                timeSpent: Math.round((new Date() - examStartTime) / 1000 / 60)
            };
            
            examResults = examResults.filter(r => r.examId !== currentExam.id);
            examResults.push(result);
            localStorage.setItem('examResults', JSON.stringify(examResults));
            
            displayExamResult(result);
        }
        
        // Mostrar resultado del examen
       function displayExamResult(result) {
    const container = document.getElementById('examContainer');
    const scoreClass = result.score >= 70 ? 'score-good' : 'score-bad';
    
    // Determinar emoji y mensaje seg√∫n el puntaje
    let emoji, message, scoreColor;
    if (result.score >= 90) {
        emoji = 'üèÜ';
        message = '¬°Excelente trabajo!';
        scoreColor = '#27ae60';
    } else if (result.score >= 70) {
        emoji = 'üéâ';
        message = '¬°Buen trabajo!';
        scoreColor = '#f39c12';
    } else if (result.score >= 50) {
        emoji = 'üìö';
        message = '¬°Sigue practicando!';
        scoreColor = '#e74c3c';
    } else {
        emoji = 'üìö';
        message = '¬°Sigue practicando!';
        scoreColor = '#e74c3c';
    }
    
    container.innerHTML = `
        <div style="background: white; border-radius: 15px; padding: 40px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); max-width: 900px; margin: 0 auto;">
            <div style="text-align: center; margin-bottom: 0px;">
                <div style="font-size: 80px; margin-bottom: 20px;">${emoji}</div>
                <h2 style="font-size: 32px; color: #2c3e50; margin-bottom: 15px;">${message}</h2>
                <div style="font-size: 72px; font-weight: bold; color: ${scoreColor}; margin-bottom: 10px;">
                    ${result.score}%
                </div>
                <p style="font-size: 20px; color: #555; margin-bottom: 30px;">
                    ${result.correctAnswers} respuestas correctas de ${result.totalQuestions}
                </p>
                
					<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; max-width: 850px; margin: 0 auto 30px;">
					<div style="padding: 20px; border-left: 6px solid var(--primary-color); border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
							<div style="font-size: 48px; font-weight: bold; color: #2c3e50; margin-bottom: 10px;">${result.score}%</div>
							<div style="font-size: 15px; color: #95a5a6;">üìä Puntuaci√≥n</div>
						</div>
						<div style="padding: 20px; border-left: 6px solid var(--primary-color); border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
							<div style="font-size: 48px; font-weight: bold; color: #2c3e50; margin-bottom: 10px;">${result.correctAnswers}/${result.totalQuestions}</div>
							<div style="font-size: 15px; color: #95a5a6;">üéØ Correctas</div>
						</div>
						<div style="padding: 20px; border-left: 6px solid var(--primary-color); border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
							<div style="font-size: 48px; font-weight: bold; color: #2c3e50; margin-bottom: 10px;">${result.timeSpent}</div>
							<div style="font-size: 15px; color: #95a5a6;">‚è±Ô∏è Minutos</div>
						</div>
					</div>	
				</div>
                
                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="backToExams()" style="padding: 15px 35px; font-size: 16px; border-radius: 25px; display: inline-flex; align-items: center; gap: 8px;">
                        üè† Volver a Ex√°menes
                    </button>
                    <button class="btn btn-success" onclick="startExam(${currentExam.id})" style="padding: 15px 35px; font-size: 16px; border-radius: 25px; display: inline-flex; align-items: center; gap: 8px;">
                        üîÑ Repetir Examen
                    </button>
                </div>
            </div>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 30px;">
                <h3 style="text-align: center; color: #2c3e50; margin-bottom: 25px; font-size: 22px;">üìã Revisi√≥n Detallada</h3>
                
                ${currentExam.questions.map((question, index) => {
                    const userAnswer = result.answers[question.id];
                    const isCorrect = userAnswer === question.correctAnswer;
                    const borderColor = isCorrect ? '#27ae60' : '#e74c3c';
                    
                    return `
                        <div style="background: white; border-left: 6px solid ${borderColor}; padding: 20px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                            <p style="font-weight: bold; font-size: 16px; color: #2c3e50; margin-bottom: 10px;">
                                üìùPregunta ${index + 1}:
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6; color: #555;">
                                ${question.text}
                            </p>
                            
                            ${isCorrect ? `
                                <div style="background: #d4edda; padding: 12px 15px; border-radius: 6px; margin-bottom: 10px;">
                                    <p style="margin: 0; color: #155724;">
                                        <strong>‚úÖ Tu respuesta:</strong> ${(() => {
                                            let option = question.options[userAnswer];
                                            return option.replace(/^[a-d]\)\s*/i, '');
                                        })()}
                                    </p>
                                </div>
                            ` : `
                                <div style="background: #f8d7da; padding: 12px 15px; border-radius: 6px; margin-bottom: 10px;">
                                    <p style="margin: 0; color: #721c24;">
                                        <strong>‚ùå Tu respuesta:</strong> ${userAnswer !== undefined ? (() => {
                                            let option = question.options[userAnswer];
                                            return option.replace(/^[a-d]\)\s*/i, '');
                                        })() : 'Sin respuesta'}
                                    </p>
                                </div>
                                <div style="background: #d4edda; padding: 12px 15px; border-radius: 6px; margin-bottom: 10px;">
                                    <p style="margin: 0; color: #155724;">
                                        <strong>‚úÖ Respuesta correcta:</strong> ${(() => {
                                            let option = question.options[question.correctAnswer];
                                            return option.replace(/^[a-d]\)\s*/i, '');
                                        })()}
                                    </p>
                                </div>
                            `}
                            
                            <div style="background: #e8f4f8; padding: 15px; border-radius: 6px; border-left: 4px solid #3498db;">
                                <p style="margin: 0 0 8px 0; font-weight: bold; color: #2c3e50;">üí° Explicaci√≥n:</p>
                                <p style="margin: 0; line-height: 1.6; color: #555;">${question.explanation}</p>
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>
        </div>
    `;
}
        // Mostrar Dashboard con an√°lisis completo
        function displayDashboard() {
            const container = document.getElementById('dashboardContainer');
            
            if (examResults.length === 0 || exams.length === 0) {
                container.innerHTML = `
                    <div class="no-data">
                        <h3>¬°Bienvenido al Dashboard!</h3>
                        <p>Realiza algunos ex√°menes para ver tu an√°lisis de progreso aqu√≠.</p>
                        <p>Una vez que completes ex√°menes, ver√°s:</p>
                        <ul style="text-align: left; display: inline-block; margin-top: 15px;">
                            <li>üìä Estad√≠sticas generales de rendimiento</li>
                            <li>üìà Progreso por √°reas de conocimiento</li>
                            <li>üéØ An√°lisis de fortalezas y debilidades</li>
                            <li>üí° Recomendaciones personalizadas</li>
                            <li>üìã Historial de mejoras</li>
                        </ul>
                    </div>
                `;
                return;
            }
            
            const dashboardData = analyzeDashboardData();
            
            container.innerHTML = `
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <h3>üìä Ex√°menes Realizados</h3>
                        <div class="metric-value">${dashboardData.totalExams}</div>
                        <div class="metric-label">Total completados</div>
                    </div>
                    
                    <div class="metric-card">
                        <h3>üéØ Promedio General</h3>
                        <div class="metric-value" style="color: ${dashboardData.averageScore >= 70 ? '#27ae60' : '#e74c3c'};">
                            ${dashboardData.averageScore}%
                        </div>
                        <div class="metric-label">Puntuaci√≥n promedio</div>
                        ${dashboardData.trend ? `<div class="trend-indicator trend-${dashboardData.trend.direction}">
                            ${dashboardData.trend.direction === 'up' ? 'üìà' : dashboardData.trend.direction === 'down' ? 'üìâ' : 'üìä'} 
                            ${dashboardData.trend.text}
                        </div>` : ''}
                    </div>
                    
                    <div class="metric-card">
                        <h3>‚úÖ Tasa de Aprobaci√≥n</h3>
                        <div class="metric-value" style="color: ${dashboardData.passRate >= 70 ? '#27ae60' : '#e74c3c'};">
                            ${dashboardData.passRate}%
                        </div>
                        <div class="metric-label">${dashboardData.passedExams} de ${dashboardData.totalExams} aprobados</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${dashboardData.passRate}%;"></div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <h3>‚è±Ô∏è Tiempo Promedio</h3>
                        <div class="metric-value">${dashboardData.averageTime}</div>
                        <div class="metric-label">minutos por examen</div>
                    </div>
                    
                    <div class="metric-card">
                        <h3>üèÜ Mejor Resultado</h3>
                        <div class="metric-value" style="color: ${dashboardData.passRate >= 70 ? '#27ae60' : '#e74c3c'};">${dashboardData.bestScore}%</div>
                        <div class="metric-label">${dashboardData.bestExam}</div>
                    </div>
                    
                    <div class="metric-card">
                        <h3>üéØ √Åreas Cubiertas</h3>
                        <div class="metric-value">${dashboardData.areasCovered}</div>
                        <div class="metric-label">de ${dashboardData.totalAreas} √°reas disponibles</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${(dashboardData.areasCovered / dashboardData.totalAreas) * 100}%;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="area-performance">
                    <h3 style="color: #27ae60; margin-bottom: 20px;">üìä Rendimiento por √Årea</h3>
                    ${dashboardData.areaPerformance.map(area => `
                        <div class="performance-item">
                            <div>
                                <div class="performance-area">${area.name}</div>
                                <small style="color: #7f8c8d;">${area.examsTaken} examen(es) ‚Ä¢ √öltimo: ${area.lastAttempt}</small>
                            </div>
                            <div>
                                <span class="performance-score ${getScoreClass(area.average)}">${area.average}%</span>
                                ${area.trend ? `<span class="trend-indicator trend-${area.trend}">
                                    ${area.trend === 'up' ? '‚ÜóÔ∏è' : area.trend === 'down' ? '‚ÜòÔ∏è' : '‚û°Ô∏è'}
                                </span>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="recommendations">
                    <h3 style="color: #3498db; margin-bottom: 20px;">üí° Recomendaciones Personalizadas</h3>
                    ${dashboardData.recommendations.map(rec => `
                        <div class="recommendation-item">
                            <span class="recommendation-priority priority-${rec.priority}">${rec.priority.toUpperCase()}</span>
                            <strong>${rec.title}</strong>
                            <p>${rec.description}</p>
                        </div>
                    `).join('')}
                </div>
                </div>
                ${dashboardData.achievements.length > 0 ? `
				<div class="chart-container" style="margin-top: 15px;">
                        <h3 style="color: #f39c12; margin-bottom: 20px;">üèÜ Logros Recientes</h3>
                        ${dashboardData.achievements.map(achievement => `
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #f39c12;">
                                <strong>${achievement.title}</strong>
                                <p style="margin: 5px 0 0 0; color: #666;">${achievement.description}</p>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            `;
        }
        
        // Analizar datos para el dashboard
        function analyzeDashboardData() {
            const totalExams = examResults.length;
            const totalScore = examResults.reduce((sum, result) => sum + result.score, 0);
            const averageScore = Math.round(totalScore / totalExams);
            const passedExams = examResults.filter(result => result.score >= 70).length;
            const passRate = Math.round((passedExams / totalExams) * 100);
            const totalTime = examResults.reduce((sum, result) => sum + result.timeSpent, 0);
            const averageTime = Math.round(totalTime / totalExams);
            
            const bestResult = examResults.reduce((best, current) => 
                current.score > best.score ? current : best
            );
            
            // An√°lisis por √°reas
            const areaStats = {};
            const areaOrder = [];
            
            examResults.forEach(result => {
                const exam = exams.find(e => e.id === result.examId);
                if (exam) {
                    if (!areaStats[exam.area]) {
                        areaStats[exam.area] = [];
                        areaOrder.push(exam.area);
                    }
                    areaStats[exam.area].push(result);
                }
            });
            
            const areaPerformance = areaOrder.map(area => {
                const results = areaStats[area];
                const areaAverage = Math.round(results.reduce((sum, r) => sum + r.score, 0) / results.length);
                const lastResult = results[results.length - 1];
                
                // Calcular tendencia
                let trend = null;
                if (results.length > 1) {
                    const firstHalf = results.slice(0, Math.floor(results.length / 2));
                    const secondHalf = results.slice(Math.floor(results.length / 2));
                    const firstAvg = firstHalf.reduce((sum, r) => sum + r.score, 0) / firstHalf.length;
                    const secondAvg = secondHalf.reduce((sum, r) => sum + r.score, 0) / secondHalf.length;
                    
                    if (secondAvg > firstAvg + 5) trend = 'up';
                    else if (secondAvg < firstAvg - 5) trend = 'down';
                    else trend = 'stable';
                }
                
                return {
                    name: area,
                    average: areaAverage,
                    examsTaken: results.length,
                    lastAttempt: lastResult.date.split(' ')[0],
                    trend: trend
                };
            });
            
            // Calcular tendencia general
            let generalTrend = null;
            if (examResults.length > 2) {
                const recent = examResults.slice(-3);
                const older = examResults.slice(-6, -3);
                
                if (older.length > 0) {
                    const recentAvg = recent.reduce((sum, r) => sum + r.score, 0) / recent.length;
                    const olderAvg = older.reduce((sum, r) => sum + r.score, 0) / older.length;
                    
                    if (recentAvg > olderAvg + 5) {
                        generalTrend = { direction: 'up', text: 'Mejorando' };
                    } else if (recentAvg < olderAvg - 5) {
                        generalTrend = { direction: 'down', text: 'Necesita atenci√≥n' };
                    } else {
                        generalTrend = { direction: 'stable', text: 'Estable' };
                    }
                }
            }
            
            // Generar recomendaciones
            const recommendations = generateRecommendations(areaPerformance, averageScore, examResults);
            
            // Generar logros
            const achievements = generateAchievements(examResults, areaPerformance);
            
            const totalAreas = [...new Set(exams.map(exam => exam.area))].length;
            const areasCovered = Object.keys(areaStats).length;
            
            return {
                totalExams,
                averageScore,
                passRate,
                passedExams,
                averageTime,
                bestScore: bestResult.score,
                bestExam: bestResult.examTitle,
                areaPerformance,
                recommendations,
                achievements,
                totalAreas,
                areasCovered,
                trend: generalTrend
            };
        }
        
        // Generar recomendaciones personalizadas
        function generateRecommendations(areaPerformance, averageScore, examResults) {
            const recommendations = [];
            
            // Recomendaciones basadas en √°reas d√©biles
            const weakAreas = areaPerformance.filter(area => area.average < 70).sort((a, b) => a.average - b.average);
            
            if (weakAreas.length > 0) {
                recommendations.push({
                    priority: 'high',
                    title: `Reforzar conocimientos en ${weakAreas[0].name}`,
                    description: `Tu puntuaci√≥n promedio en esta √°rea es ${weakAreas[0].average}%. Considera revisar los conceptos fundamentales y practicar m√°s ejercicios.`
                });
            }
            
            // Recomendaciones basadas en tendencias
            const decliningAreas = areaPerformance.filter(area => area.trend === 'down');
            if (decliningAreas.length > 0) {
                recommendations.push({
                    priority: 'medium',
                    title: `Atenci√≥n: Declive en ${decliningAreas[0].name}`,
                    description: `Se detect√≥ una tendencia descendente en esta √°rea. Revisa los temas recientes y considera hacer m√°s pr√°ctica.`
                });
            }
            
            // Recomendaciones basadas en tiempo
            const avgTime = examResults.reduce((sum, r) => sum + r.timeSpent, 0) / examResults.length;
            const maxTime = Math.max(...examResults.map(r => r.timeSpent));
            
            if (maxTime > avgTime * 1.5) {
                recommendations.push({
                    priority: 'low',
                    title: 'Optimizar gesti√≥n del tiempo',
                    description: `Algunos ex√°menes te toman m√°s tiempo del promedio. Practica t√©cnicas de lectura r√°pida y gesti√≥n del tiempo.`
                });
            }
            
            // Recomendaciones positivas
            const strongAreas = areaPerformance.filter(area => area.average >= 85);
            if (strongAreas.length > 0 && averageScore >= 70) {
                recommendations.push({
                    priority: 'low',
                    title: `¬°Excelente dominio en ${strongAreas[0].name}!`,
                    description: `Mant√©n este nivel de excelencia y considera ayudar a otros o profundizar en temas avanzados de esta √°rea.`
                });
            }
            
            return recommendations;
        }
        
        // Generar logros
        function generateAchievements(examResults, areaPerformance) {
            const achievements = [];
            
            // Logro por cantidad de ex√°menes
            if (examResults.length >= 5) {
                achievements.push({
                    title: 'üéØ Estudiante Dedicado',
                    description: `Has completado ${examResults.length} ex√°menes. ¬°Mant√©n el ritmo de estudio!`
                });
            }
            
            // Logro por puntaje perfecto
            const perfectScores = examResults.filter(r => r.score === 100);
            if (perfectScores.length > 0) {
                achievements.push({
                    title: 'üèÜ Puntuaci√≥n Perfecta',
                    description: `¬°Obtuviste 100% en "${perfectScores[perfectScores.length - 1].examTitle}"!`
                });
            }
            
            // Logro por mejor√≠a
            if (examResults.length > 1) {
                const firstScore = examResults[0].score;
                const lastScore = examResults[examResults.length - 1].score;
                if (lastScore > firstScore + 20) {
                    achievements.push({
                        title: 'üìà Gran Mejor√≠a',
                        description: `Has mejorado ${lastScore - firstScore} puntos desde tu primer examen.`
                    });
                }
            }
            
            // Logro por consistencia
            const recentScores = examResults.slice(-5).map(r => r.score);
            if (recentScores.length >= 3 && recentScores.every(score => score >= 70)) {
                achievements.push({
                    title: 'üéñÔ∏è Rendimiento Consistente',
                    description: 'Has mantenido una puntuaci√≥n superior a 70% en tus √∫ltimos ex√°menes.'
                });
            }
            
            return achievements;
        }
        
        // Obtener clase CSS para el puntaje
        function getScoreClass(score) {
            if (score >= 85) return 'score-excellent';
            if (score >= 70) return 'score-good';
            return 'score-needs-improvement';
        }
        
        // Volver a la lista de ex√°menes
        function backToExams() {
            showTab('examenes');
        }
        
        // Cancelar examen
        function cancelExam() {
            if (examTimer) {
                clearInterval(examTimer);
            }
            
            if (confirm('¬øEst√°s seguro de que quieres cancelar el examen?')) {
                backToExams();
            } else {
                startTimer();
            }
        }
        
        // Inicializar cuando se carga la p√°gina
		// Funciones para manejo de temas
		function changeTheme(theme) {
			document.body.setAttribute('data-theme', theme);
			localStorage.setItem('selectedTheme', theme);
			
			// Actualizar vista de tema activo
			document.querySelectorAll('.theme-option').forEach(option => {
				option.classList.remove('active');
			});
			
			event.target.closest('.theme-option').classList.add('active');
		}

		function loadSavedTheme() {
			const savedTheme = localStorage.getItem('selectedTheme') || 'dark';
			if (savedTheme !== 'dark') {
				document.body.setAttribute('data-theme', savedTheme);
			}
			
			// Marcar tema activo
			setTimeout(() => {
				const themeOptions = document.querySelectorAll('.theme-option');
				const themes = ['blue', 'green', 'orange', 'dark'];
				const themeIndex = themes.indexOf(savedTheme);
				if (themeIndex >= 0 && themeOptions[themeIndex]) {
					themeOptions[themeIndex].classList.add('active');
				}
			}, 100);
		}

		// Formatear fecha en formato DD/MM/YYYY HH:MM
		function formatDate(date) {
			const day = date.getDate();
			const month = date.getMonth() + 1;
			const year = date.getFullYear();
			const hours = date.getHours().toString().padStart(2, '0');
			const minutes = date.getMinutes().toString().padStart(2, '0');
			
			return `${day}/${month}/${year} ${hours}:${minutes}`;
		}

        window.onload = init;
    </script>
</body>
</html>
